{"status":{},"contains_secrets":false,"product_version":"3.3.1","spec":{"description":"","resources":{"client_attrs":{"fc73d065_deployment":{"y":-706.5856090338,"x":342.8146253912},"None":{"y":-144.0220947266,"x":165.048828125},"007e9ee0_deployment":{"y":-711.4024660422,"x":133.0733285179}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"e0f7e251_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"5061d873_runbook","main_task_local_reference":{"kind":"app_task","name":"e0f7e251_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"94d8f7c0_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9aa2d474_runbook","main_task_local_reference":{"kind":"app_task","name":"94d8f7c0_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"d7d233e7_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a7b2b618_runbook","main_task_local_reference":{"kind":"app_task","name":"d7d233e7_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"d7a2470a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4426315f_runbook","main_task_local_reference":{"kind":"app_task","name":"d7a2470a_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"f5149bf3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"bd3889ce_runbook","main_task_local_reference":{"kind":"app_task","name":"f5149bf3_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"master","port_list":[],"tier":"","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"_JOIN_COMMAND","value":"","label":"","attrs":{"type":""},"editables":{"value":false},"is_hidden":true,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MY_DOCKER_VERSION","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MY_K8S_VERSION","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a43f69ab_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a5832d96_runbook","main_task_local_reference":{"kind":"app_task","name":"a43f69ab_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"5bc517e2_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"e34ef29e_runbook","main_task_local_reference":{"kind":"app_task","name":"5bc517e2_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"baddd0e8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"75f6fc0f_runbook","main_task_local_reference":{"kind":"app_task","name":"baddd0e8_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a3935767_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"0ed6f0be_runbook","main_task_local_reference":{"kind":"app_task","name":"a3935767_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a49d1341_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"876ab1a8_runbook","main_task_local_reference":{"kind":"app_task","name":"a49d1341_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[{"kind":"app_service","name":"master"}],"name":"worker","port_list":[],"tier":"","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MY_DOCKER_VERSION","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"MY_K8S_VERSION","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AHV_VM","name":"k1m","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":true,"login_credential_local_reference":{"kind":"app_credential","name":"NUTANIX"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"guest_customization":true,"disk_list":true}}},"os_type":"Linux","create_spec":{"name":"k8sm","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"345efae5-3614-4813-bb9f-2c4b69daa28e"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":4,"gpu_list":[],"memory_size_mib":8192,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nrepo_update: true\nrepo_upgrade: all\npackage_upgrade: true\ndisable_root: False\nssh_enabled: True\nchpasswd: { expire: False }\nusers:\n- name: nutanix\n  sudo: ALL=(ALL) NOPASSWD:ALL\n  groups: wheel, users\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCvusjsw3uq3kow59nUrW7IDni9vvI+pW9fyLoWEcoir4pzdMrL3aqIcsw6Wd3twX04NrWdxBw20vndYk+JDrN4hMD7LoBQdoV7+qV5rCMMuZrm96r15K\/CwMyL6TA6WDJ9GJJx6iLp5CBB5ZjF6+02uc6DApBymiExFWYL++mv2THPWdBlxghmwlF8eOE+GfLtsTE\/y5cyAHWmf6sxCzGCIMlHkXIm2Yl+Q4OUNuPy0qUFT+I8+kX8ccYWbA\/tTqdcS6H2oYY8QcGoGa2HyC1IVuuY0adlbFrNRRiu\/A0uCmQyZwBFy+U0GHppq+\/3VwFxj50fOuAq4n1dw\/ER\/NlH centos\npackages:\n - git\n - curl\n - htop\n - wget\nmounts:\n - [ sdb, \/home ]"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"b28cb30d-213b-41df-84af-4d34b9293110","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"Ubuntu2004-200G","uuid":"2dbab86f-ca0a-41d3-9cce-5cff1a8d46a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}},{"data_source_reference":null,"type":"","disk_size_mib":102400,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"k1w","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":true,"login_credential_local_reference":{"kind":"app_credential","name":"NUTANIX"}},"editables":{"create_spec":{"resources":{"nic_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"memory_size_mib":true,"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"k8sw@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"345efae5-3614-4813-bb9f-2c4b69daa28e"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":4,"gpu_list":[],"memory_size_mib":8192,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nrepo_update: true\nrepo_upgrade: all\npackage_upgrade: true\ndisable_root: False\nssh_enabled: True\nchpasswd: { expire: False }\nusers:\n- name: nutanix\n  sudo: ALL=(ALL) NOPASSWD:ALL\n  groups: wheel, users\n  ssh_authorized_keys:\n    - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCvusjsw3uq3kow59nUrW7IDni9vvI+pW9fyLoWEcoir4pzdMrL3aqIcsw6Wd3twX04NrWdxBw20vndYk+JDrN4hMD7LoBQdoV7+qV5rCMMuZrm96r15K\/CwMyL6TA6WDJ9GJJx6iLp5CBB5ZjF6+02uc6DApBymiExFWYL++mv2THPWdBlxghmwlF8eOE+GfLtsTE\/y5cyAHWmf6sxCzGCIMlHkXIm2Yl+Q4OUNuPy0qUFT+I8+kX8ccYWbA\/tTqdcS6H2oYY8QcGoGa2HyC1IVuuY0adlbFrNRRiu\/A0uCmQyZwBFy+U0GHppq+\/3VwFxj50fOuAq4n1dw\/ER\/NlH centos\npackages:\n - git\n - curl\n - htop\n - wget\n"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"b28cb30d-213b-41df-84af-4d34b9293110","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"image","type":"","name":"Ubuntu2004-200G","uuid":"2dbab86f-ca0a-41d3-9cce-5cff1a8d46a9"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"nutanix","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"NUTANIX","cred_class":"static"}],"package_definition_list":[{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"master"}],"name":"Package1","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Initial"},{"kind":"app_task","name":"InsertPrivateKey"},{"kind":"app_task","name":"UpdateHostFile"},{"kind":"app_task","name":"SetMasterHostName"},{"kind":"app_task","name":"InstallDockerAndK8S"},{"kind":"app_task","name":"Task 8"},{"kind":"app_task","name":"InitializeK8SMaster"},{"kind":"app_task","name":"InstallHelm3"}],"name":"2e4c2002_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"InsertPrivateKey"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"UpdateHostFile"}},{"from_task_reference":{"kind":"app_task","name":"UpdateHostFile"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"SetMasterHostName"}},{"from_task_reference":{"kind":"app_task","name":"SetMasterHostName"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InstallDockerAndK8S"}},{"from_task_reference":{"kind":"app_task","name":"Initial"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InsertPrivateKey"}},{"from_task_reference":{"kind":"app_task","name":"InitializeK8SMaster"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InstallHelm3"}},{"from_task_reference":{"kind":"app_task","name":"InstallDockerAndK8S"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Task 8"}},{"from_task_reference":{"kind":"app_task","name":"Task 8"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InitializeK8SMaster"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Initial","attrs":{"exit_status":[],"script":"#script\nprint \"MY_K8S_VERSION=@@{K8S_VERSION}@@\"\nprint \"MY_DOCKER_VERSION=@@{DOCKER_VERSION}@@\"","eval_variables":["MY_K8S_VERSION","MY_DOCKER_VERSION"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InsertPrivateKey","attrs":{"script":"#!\/bin\/bash -ex\n\ncat <<EOF | tee $USER.priv\n-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEAr7rI7MN7qt5KMOfZ1K1uyA54vb7yPqVvX8i6FhHKIq+Kc3TK\ny92qiHLMOlnd7cF9ODa1ncQcNtL53WJPiQ6zeITA+y6AUHaFe\/qleawjDLma5veq\n9eSvwsDMi+kwOlgyfRiSceoi6eQgQeWYxevtNrnOgwKQcpohMRVmC\/vpr9kxz1nQ\nZcYIZsJRfHjhPhny7bExP8uXMgB1pn+rMQsxgiDJR5FyJtmJfkODlDbj8tKlBU\/i\nPPpF\/HHGFmwP7U6nXEuh9qGGPEHBqBmth8gtSFbrmNGnZWxazUUYrvwNLgpkMmcA\nRcvlNBh6aavv91cBcY+dHzrgKuJ9XcPxEfzZRwIDAQABAoIBABof66T\/PtBdMaxp\nm4G5suF8\/UhALeVQVOlpfviu9l0Huc6GS2vZbXPRlTkLiSnCfSoxP\/jPYd5oqQrX\nhbl7fQTqv4HYHO1ZYWjYD2eyRpeqtDOoGDtsHxEV9pLKPQg\/emoMkCDtTPl2l7EU\nQA0UkPR01RW2+OCAt3SDmOMpNUmWAkKCDgIAJwXKTn7yi127B6vCImpMlDli4zNg\nxY58gW8QRNpw2\/e6EjXW8lnhIYHrnzN2dYuZOtCh\/6dhkTBxpczYVH1ax7ZOoKaA\n1hT9SDXJ6BnjprtRxCcwr4zAV+qgfW7eYvb1uel76ELsz+Jy4SyH\/jS0X6WNkd3z\nIhyZDTECgYEA5hzfvWbkfjsu7NpZeqYc+ABEcRfBXknF3JxnLwG+Kq63yOAEtR0c\nfDTEP\/iLw0NCWhw49tm1n28h6OM3bKH\/VPBRXM93yR5VWq2U7qQ1HSRwvcl7r+KL\nMbSbQ4iDm4s5aK8y4t1d0GLd15jdjajK0hivVN61HuWQC6yU6i82Bt8CgYEAw3+0\nawQvNXXSLvj2HTMbZXqvkGcghCkSxn0abmIrDglccbYKo4ket\/\/5i1FgJ3al40CY\nWe0j9AqY7ZX39AmtskLTveVqS5r8HbGDVnMHJFgUKd+88xkHlr6EZa3X79z6p0p0\nJu\/O73LGMM\/HjrSHM9sQ0c+g8M4AFhvwrI77ApkCgYAS5pY+EWB9OdE95SVqXJCO\nkj8M5v2cCAU3fKVBCCydhuJTnorkcXKwhQkFlB2uuSyPCDhpljJD2TX40gjwZFH7\noQ2dyPC21UX\/f7h27YfrT93uyMjfBoWWXJZQMrtUoFfj0FgmqDYXcrd0CPtRsmaO\nYTatiulnk0WEn\/VPUvdmEwKBgALdHAd1SDvAPhPyEajb1srlwSycVh2ZfGzr6Dc1\nuOu7t17zC7TZjVmkpkMkLgRl+Igbqh+nGZ+5iAPy7m7ktWanE\/L0KVpyKr9Emmfp\nx3EA2UrDvEDTXQkYQVg7863Pztwkew8W9DENvVl5sbKlclWQH+7y26irW9T3E89z\nSLoBAoGBALfSQnn+Ieg626763ziFSo85OXXTBEfKcReEqc7bMmv\/GYjpz2dpngut\nV67OAPGnlburEqlmCcvr9lOB7UzYH5t3PcdlrYbWZ07HC8G9RdpVPcR42CgcT1Fy\nfKnWCu7q3uafdOyNnLxlelR7UGr7DYx7XgHIVQ2F1wNwggYrE8d2\n-----END RSA PRIVATE KEY-----\nEOF\n\nchmod 600 $USER.priv\n\nK8S_VERSION=\"@@{K8S_VERSION}@@\"\nDOCKER_VERSION=\"@@{DOCKER_VERSION}@@\"\n\n## K8S_VERSION=@@{K8S_VERSION}@@\n\necho $K8S_VERSION\necho $DOCKER_VERSION","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"UpdateHostFile","attrs":{"script":"#!\/bin\/bash -ex\n\ncat <<EOF | sudo tee -a \/etc\/hosts\n\n@@{k1m.address}@@      k8sm\n@@{k1w.address[0]}@@      k8sw0\n@@{k1w.address[1]}@@      k8sw1\n@@{k1w.address[2]}@@      k8sw2\n\nEOF\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"SetMasterHostName","attrs":{"script":"#!\/bin\/bash -ex\n\nsudo hostnamectl set-hostname k8sm\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InstallDockerAndK8S","attrs":{"script":"#!\/bin\/bash -ex\n\nK8S_VERSION=\"@@{calm_array_K8S_VERSION}@@\"\n\ncat <<EOF | sudo tee \/etc\/apt\/apt.conf.d\/20auto-upgrades\nAPT::Periodic::Update-Package-Lists \"0\";\nAPT::Periodic::Download-Upgradeable-Packages \"0\";\nAPT::Periodic::AutocleanInterval \"0\";\nAPT::Periodic::Unattended-Upgrade \"1\";\nEOF\n\n# sudo modprobe br_netfilter\n\ncat <<EOF | sudo tee \/etc\/modules-load.d\/k8s.conf\nbr_netfilter\nEOF\n\n\ncat <<EOF | sudo tee \/etc\/sysctl.d\/k8s.conf\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nEOF\n\nsudo sysctl --system\n\n\nif [ \"$(. \/etc\/os-release; echo $NAME)\" = \"Ubuntu\" ]; then\n  sudo apt-get -y update\n  sudo apt-get install -y \\\n    apt-transport-https \\\n    ca-certificates \\\n    curl \\\n    gnupg \\\n    lsb-release\n  curl -fsSL https:\/\/download.docker.com\/linux\/ubuntu\/gpg | sudo apt-key --keyring \/etc\/apt\/trusted.gpg.d\/docker.gpg add -\n  sudo add-apt-repository \\\n  \"deb [arch=amd64] https:\/\/download.docker.com\/linux\/ubuntu \\\n  $(lsb_release -cs) \\\n  stable\"\n  sudo apt-get update -y\nelse\n  sudo yum update -y\n  sudo yum install -y yum-utils\n  sudo yum-config-manager \\\n    --add-repo \\\n    https:\/\/download.docker.com\/linux\/centos\/docker-ce.repo\nfi\n  \n\nDOCKER_VERSION=\"@@{DOCKER_VERSION}@@\"\nUBUNTU_CODENAME=\"$(. \/etc\/os-release; echo $UBUNTU_CODENAME)\"\n\nif [ \"$(. \/etc\/os-release; echo $NAME)\" = \"Ubuntu\" ]; then\n  sudo apt-get install -y docker-ce=5:${DOCKER_VERSION}~3-0~ubuntu-$UBUNTU_CODENAME docker-ce-cli=5:${DOCKER_VERSION}~3-0~ubuntu-$UBUNTU_CODENAME  containerd.io\n  # sudo apt-get install -y containerd.io\nelse\n  sudo yum install -y docker-ce-${DOCKER_VERSION} docker-ce-cli-${DOCKER_VERSION} containerd.io\nfi\n\n# sudo systemctl enable --now docker\ncat <<EOF | sudo tee \/etc\/docker\/daemon.json\n{\n  \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"100m\"\n  },\n  \"storage-driver\": \"overlay2\"\n}\nEOF\n\nsudo mkdir -p \/etc\/systemd\/system\/docker.service.d\n\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Task 8","attrs":{"script":"#!\/bin\/bash -ex\n\nK8S_VERSION=\"@@{K8S_VERSION}@@\"\nDOCKER_VERSION=\"@@{DOCKER_VERSION}@@\"\nUBUNTU_CODENAME=\"$(. \/etc\/os-release; echo $UBUNTU_CODENAME)\"\n\nsudo swapoff -a\n\nif [ \"$(. \/etc\/os-release; echo $NAME)\" = \"Ubuntu\" ]; then\n  sudo apt-get install -y apt-transport-https ca-certificates curl\n  curl -s https:\/\/packages.cloud.google.com\/apt\/doc\/apt-key.gpg | sudo apt-key add -\ncat <<EOF | sudo tee \/etc\/apt\/sources.list.d\/kubernetes.list\ndeb https:\/\/apt.kubernetes.io\/ kubernetes-xenial main\nEOF\n  sudo apt-get update -y\n  sudo apt-get install -y kubelet=$K8S_VERSION-00 kubeadm=$K8S_VERSION-00 kubectl=$K8S_VERSION-00\n  sudo apt-mark hold kubelet kubeadm kubectl\n  # sudo rm -R \/etc\/systemd\/system\/kubelet.service.d\n  # sudo rm \/etc\/systemd\/system\/kubelet.service\n  sudo systemctl daemon-reload\nelse\n  cat <<EOF | sudo tee \/etc\/yum.repos.d\/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=https:\/\/packages.cloud.google.com\/yum\/repos\/kubernetes-el7-\\$basearch\nenabled=1\ngpgcheck=1\nrepo_gpgcheck=1\ngpgkey=https:\/\/packages.cloud.google.com\/yum\/doc\/yum-key.gpg https:\/\/packages.cloud.google.com\/yum\/doc\/rpm-package-key.gpg\nexclude=kubelet kubeadm kubectl\nEOF\n\n# Set SELinux in permissive mode (effectively disabling it)\n  sudo setenforce 0\n  sudo sed -i 's\/^SELINUX=enforcing$\/SELINUX=permissive\/' \/etc\/selinux\/config\n  sudo yum install -y kubelet-${K8S_VERSION} kubeadm-${K8S_VERSION} kubectl-${K8S_VERSION} --disableexcludes=kubernetes\nfi\n\n\n\n# sudo systemctl enable --now kubelet\n\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InitializeK8SMaster","attrs":{"script":"#!\/bin\/bash -ex\n\n# sudo kubeadm reset -f\n\n_k8s_token=`kubeadm token generate`\n\nsudo kubeadm init --token ${_k8s_token}| tee \/home\/$USER\/kubeadm.log | tail -n 2 | tee  \/home\/$USER\/join-cmd.sh\n\nmkdir -p \/home\/$USER\/.kube\nsudo cp -i \/etc\/kubernetes\/admin.conf \/home\/$USER\/.kube\/config\nsudo chown $(id -u):$(id -g) \/home\/$USER\/.kube\/config\n\ncurl https:\/\/docs.projectcalico.org\/manifests\/calico.yaml -O\nkubectl apply -f calico.yaml\n\ncat \/home\/$USER\/join-cmd.sh\n\nscp -o StrictHostKeyChecking=no -i \/home\/$USER\/$USER.priv \/home\/$USER\/join-cmd.sh $USER@k8sw0:\nscp -o StrictHostKeyChecking=no -i \/home\/$USER\/$USER.priv \/home\/$USER\/join-cmd.sh $USER@k8sw1:\nscp -o StrictHostKeyChecking=no -i \/home\/$USER\/$USER.priv \/home\/$USER\/join-cmd.sh $USER@k8sw2:\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InstallHelm3","attrs":{"script":"#!\/bin\/bash -ex\n\ncurl -fsSL -o get_helm.sh https:\/\/raw.githubusercontent.com\/helm\/helm\/main\/scripts\/get-helm-3\n\nchmod 700 get_helm.sh\n.\/get_helm.sh\n\nhelm repo add bitnami https:\/\/charts.bitnami.com\/bitnami\nhelm repo update","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"3b1d606b_runbook","main_task_local_reference":{"kind":"app_task","name":"2e4c2002_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package1"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"6e477f25_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"6cd3da2f_runbook","main_task_local_reference":{"kind":"app_task","name":"6e477f25_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"worker"}],"name":"Package2","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Initialize"},{"kind":"app_task","name":"InsertPrivateKey"},{"kind":"app_task","name":"UpdateHostFile"},{"kind":"app_task","name":"setHostName"},{"kind":"app_task","name":"InstallDockerAndK8S"},{"kind":"app_task","name":"Task 6"},{"kind":"app_task","name":"JoinK8SCluster"}],"name":"6c3acea0_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"InsertPrivateKey"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"UpdateHostFile"}},{"from_task_reference":{"kind":"app_task","name":"Initialize"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InsertPrivateKey"}},{"from_task_reference":{"kind":"app_task","name":"InstallDockerAndK8S"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"Task 6"}},{"from_task_reference":{"kind":"app_task","name":"Task 6"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"JoinK8SCluster"}},{"from_task_reference":{"kind":"app_task","name":"UpdateHostFile"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"setHostName"}},{"from_task_reference":{"kind":"app_task","name":"setHostName"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"InstallDockerAndK8S"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Initialize","attrs":{"exit_status":[],"script":"#script\nprint \"MY_K8S_VERSION=@@{K8S_VERSION}@@\"\nprint \"MY_DOCKER_VERSION=@@{DOCKER_VERSION}@@\"\nprint \"host_name=@@{name}@@\".lower()\nprint \"all_worker_names=@@{k1w.name}@@\".lower()","eval_variables":["MY_K8S_VERSION","MY_DOCKER_VERSION"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InsertPrivateKey","attrs":{"script":"#!\/bin\/bash -ex\n\ncat <<EOF | tee \/home\/$USER\/$USER.priv\n-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEAr7rI7MN7qt5KMOfZ1K1uyA54vb7yPqVvX8i6FhHKIq+Kc3TK\ny92qiHLMOlnd7cF9ODa1ncQcNtL53WJPiQ6zeITA+y6AUHaFe\/qleawjDLma5veq\n9eSvwsDMi+kwOlgyfRiSceoi6eQgQeWYxevtNrnOgwKQcpohMRVmC\/vpr9kxz1nQ\nZcYIZsJRfHjhPhny7bExP8uXMgB1pn+rMQsxgiDJR5FyJtmJfkODlDbj8tKlBU\/i\nPPpF\/HHGFmwP7U6nXEuh9qGGPEHBqBmth8gtSFbrmNGnZWxazUUYrvwNLgpkMmcA\nRcvlNBh6aavv91cBcY+dHzrgKuJ9XcPxEfzZRwIDAQABAoIBABof66T\/PtBdMaxp\nm4G5suF8\/UhALeVQVOlpfviu9l0Huc6GS2vZbXPRlTkLiSnCfSoxP\/jPYd5oqQrX\nhbl7fQTqv4HYHO1ZYWjYD2eyRpeqtDOoGDtsHxEV9pLKPQg\/emoMkCDtTPl2l7EU\nQA0UkPR01RW2+OCAt3SDmOMpNUmWAkKCDgIAJwXKTn7yi127B6vCImpMlDli4zNg\nxY58gW8QRNpw2\/e6EjXW8lnhIYHrnzN2dYuZOtCh\/6dhkTBxpczYVH1ax7ZOoKaA\n1hT9SDXJ6BnjprtRxCcwr4zAV+qgfW7eYvb1uel76ELsz+Jy4SyH\/jS0X6WNkd3z\nIhyZDTECgYEA5hzfvWbkfjsu7NpZeqYc+ABEcRfBXknF3JxnLwG+Kq63yOAEtR0c\nfDTEP\/iLw0NCWhw49tm1n28h6OM3bKH\/VPBRXM93yR5VWq2U7qQ1HSRwvcl7r+KL\nMbSbQ4iDm4s5aK8y4t1d0GLd15jdjajK0hivVN61HuWQC6yU6i82Bt8CgYEAw3+0\nawQvNXXSLvj2HTMbZXqvkGcghCkSxn0abmIrDglccbYKo4ket\/\/5i1FgJ3al40CY\nWe0j9AqY7ZX39AmtskLTveVqS5r8HbGDVnMHJFgUKd+88xkHlr6EZa3X79z6p0p0\nJu\/O73LGMM\/HjrSHM9sQ0c+g8M4AFhvwrI77ApkCgYAS5pY+EWB9OdE95SVqXJCO\nkj8M5v2cCAU3fKVBCCydhuJTnorkcXKwhQkFlB2uuSyPCDhpljJD2TX40gjwZFH7\noQ2dyPC21UX\/f7h27YfrT93uyMjfBoWWXJZQMrtUoFfj0FgmqDYXcrd0CPtRsmaO\nYTatiulnk0WEn\/VPUvdmEwKBgALdHAd1SDvAPhPyEajb1srlwSycVh2ZfGzr6Dc1\nuOu7t17zC7TZjVmkpkMkLgRl+Igbqh+nGZ+5iAPy7m7ktWanE\/L0KVpyKr9Emmfp\nx3EA2UrDvEDTXQkYQVg7863Pztwkew8W9DENvVl5sbKlclWQH+7y26irW9T3E89z\nSLoBAoGBALfSQnn+Ieg626763ziFSo85OXXTBEfKcReEqc7bMmv\/GYjpz2dpngut\nV67OAPGnlburEqlmCcvr9lOB7UzYH5t3PcdlrYbWZ07HC8G9RdpVPcR42CgcT1Fy\nfKnWCu7q3uafdOyNnLxlelR7UGr7DYx7XgHIVQ2F1wNwggYrE8d2\n-----END RSA PRIVATE KEY-----\nEOF\n\nchmod 600 \/home\/$USER\/$USER.priv\n\nK8S_VERSION=\"@@{K8S_VERSION}@@\"\necho $K8S_VERSION","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"UpdateHostFile","attrs":{"script":"#!\/bin\/bash -ex\n\ncat <<EOF | sudo tee -a \/etc\/hosts\n\n@@{k1m.address}@@      k8sm\n@@{k1w.address[0]}@@      k8sw0\n@@{k1w.address[1]}@@      k8sw1\n@@{k1w.address[2]}@@      k8sw2\n\nEOF\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"setHostName","attrs":{"script":"#!\/bin\/bash -ex\n\nDOCKER_VERSION=\"@@{DOCKER_VERSION}@@\"\necho $DOCKER_VERSION\n\nsudo hostnamectl set-hostname \"@@{name}@@\"","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"InstallDockerAndK8S","attrs":{"script":"#!\/bin\/bash -ex\n\nK8S_VERSION=\"@@{calm_array_K8S_VERSION}@@\"\n\ncat <<EOF | sudo tee \/etc\/apt\/apt.conf.d\/20auto-upgrades\nAPT::Periodic::Update-Package-Lists \"0\";\nAPT::Periodic::Download-Upgradeable-Packages \"0\";\nAPT::Periodic::AutocleanInterval \"0\";\nAPT::Periodic::Unattended-Upgrade \"1\";\nEOF\n\n# sudo modprobe br_netfilter\n\ncat <<EOF | sudo tee \/etc\/modules-load.d\/k8s.conf\nbr_netfilter\nEOF\n\n\ncat <<EOF | sudo tee \/etc\/sysctl.d\/k8s.conf\nnet.bridge.bridge-nf-call-ip6tables = 1\nnet.bridge.bridge-nf-call-iptables = 1\nEOF\n\nsudo sysctl --system\n\n\nif [ \"$(. \/etc\/os-release; echo $NAME)\" = \"Ubuntu\" ]; then\n  sudo apt-get -y update\n  sudo apt-get install -y \\\n    apt-transport-https \\\n    ca-certificates \\\n    curl \\\n    gnupg \\\n    lsb-release\n  curl -fsSL https:\/\/download.docker.com\/linux\/ubuntu\/gpg | sudo apt-key --keyring \/etc\/apt\/trusted.gpg.d\/docker.gpg add -\n  sudo add-apt-repository \\\n  \"deb [arch=amd64] https:\/\/download.docker.com\/linux\/ubuntu \\\n  $(lsb_release -cs) \\\n  stable\"\n  sudo apt-get update -y\nelse\n  sudo yum update -y\n  sudo yum install -y yum-utils\n  sudo yum-config-manager \\\n    --add-repo \\\n    https:\/\/download.docker.com\/linux\/centos\/docker-ce.repo\nfi\n  \n\nDOCKER_VERSION=\"@@{DOCKER_VERSION}@@\"\nUBUNTU_CODENAME=\"$(. \/etc\/os-release; echo $UBUNTU_CODENAME)\"\n\nif [ \"$(. \/etc\/os-release; echo $NAME)\" = \"Ubuntu\" ]; then\n  sudo apt-get install -y docker-ce=5:${DOCKER_VERSION}~3-0~ubuntu-$UBUNTU_CODENAME docker-ce-cli=5:${DOCKER_VERSION}~3-0~ubuntu-$UBUNTU_CODENAME  containerd.io\n  # sudo apt-get install -y containerd.io\nelse\n  sudo yum install -y docker-ce-${DOCKER_VERSION} docker-ce-cli-${DOCKER_VERSION} containerd.io\nfi\n\n# sudo systemctl enable --now docker\ncat <<EOF | sudo tee \/etc\/docker\/daemon.json\n{\n  \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"100m\"\n  },\n  \"storage-driver\": \"overlay2\"\n}\nEOF\n\nsudo mkdir -p \/etc\/systemd\/system\/docker.service.d\n\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Task 6","attrs":{"script":"#!\/bin\/bash -ex\n\nK8S_VERSION=\"@@{K8S_VERSION}@@\"\nDOCKER_VERSION=\"@@{DOCKER_VERSION}@@\"\nUBUNTU_CODENAME=\"$(. \/etc\/os-release; echo $UBUNTU_CODENAME)\"\n\nsudo swapoff -a\n\nif [ \"$(. \/etc\/os-release; echo $NAME)\" = \"Ubuntu\" ]; then\n  sudo apt-get install -y apt-transport-https ca-certificates curl\n  curl -s https:\/\/packages.cloud.google.com\/apt\/doc\/apt-key.gpg | sudo apt-key add -\ncat <<EOF | sudo tee \/etc\/apt\/sources.list.d\/kubernetes.list\ndeb https:\/\/apt.kubernetes.io\/ kubernetes-xenial main\nEOF\n  sudo apt-get update -y\n  sudo apt-get install -y kubelet=$K8S_VERSION-00 kubeadm=$K8S_VERSION-00 kubectl=$K8S_VERSION-00\n  sudo apt-mark hold kubelet kubeadm kubectl\n  # sudo rm -R \/etc\/systemd\/system\/kubelet.service.d\n  # sudo rm \/etc\/systemd\/system\/kubelet.service\n  sudo systemctl daemon-reload\nelse\n  cat <<EOF | sudo tee \/etc\/yum.repos.d\/kubernetes.repo\n[kubernetes]\nname=Kubernetes\nbaseurl=https:\/\/packages.cloud.google.com\/yum\/repos\/kubernetes-el7-\\$basearch\nenabled=1\ngpgcheck=1\nrepo_gpgcheck=1\ngpgkey=https:\/\/packages.cloud.google.com\/yum\/doc\/yum-key.gpg https:\/\/packages.cloud.google.com\/yum\/doc\/rpm-package-key.gpg\nexclude=kubelet kubeadm kubectl\nEOF\n\n# Set SELinux in permissive mode (effectively disabling it)\n  sudo setenforce 0\n  sudo sed -i 's\/^SELINUX=enforcing$\/SELINUX=permissive\/' \/etc\/selinux\/config\n  sudo yum install -y kubelet-${K8S_VERSION} kubeadm-${K8S_VERSION} kubectl-${K8S_VERSION} --disableexcludes=kubernetes\nfi\n\n\n\n# sudo systemctl enable --now kubelet\n\n","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"worker"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"JoinK8SCluster","attrs":{"script":"#!\/bin\/bash\n\nwhile [ ! -f \/home\/$USER\/join-cmd.sh ]; do sleep 10; done\n\nchmod +x \/home\/$USER\/join-cmd.sh\n\nsudo \/home\/$USER\/join-cmd.sh","type":"","command_line_args":"","exit_status":[],"script_type":"sh"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"22c3f9df_runbook","main_task_local_reference":{"kind":"app_task","name":"6c3acea0_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"12457205_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"66d6dd37_runbook","main_task_local_reference":{"kind":"app_task","name":"12457205_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"Ubuntu2104AHV","version":"","options":{"type":"","name":"Ubuntu21.04AHV","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"https:\/\/cloud-images.ubuntu.com\/releases\/hirsute\/release\/ubuntu-21.04-server-cloudimg-amd64.img","version":{"product_version":"21.04","type":"","product_name":"Ubuntu"},"architecture":"X86_64","type":""},"description":""},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"fc73d065_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package1"}],"substrate_local_reference":{"kind":"app_substrate","name":"k1m"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"007e9ee0_deployment","min_replicas":"2","default_replicas":"3","depends_on_list":[],"editables":{"min_replicas":true,"default_replicas":true,"max_replicas":true},"published_service_local_reference_list":[],"max_replicas":"10","package_local_reference_list":[{"kind":"app_package","name":"Package2"}],"substrate_local_reference":{"kind":"app_substrate","name":"k1w"},"variable_list":[],"description":""}],"environment_reference_list":[],"patch_list":[{"name":"Config1","type":"PATCH","is_system_generated":false,"variable_list":[],"attrs_list":[{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"fc73d065_deployment"},"data":{"num_vcpus_per_socket_ruleset":{"type":""},"num_sockets_ruleset":{"type":""},"disk_delete_allowed":false,"pre_defined_nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"editable":false,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"0c9bc92c-3593-4482-9785-283ea8532e57"},"operation":"modify","identifier":"0","type":""}],"categories_delete_allowed":false,"pre_defined_categories":[],"pre_defined_disk_list":[{"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"},"operation":"modify","data_source_reference":{"kind":"image","type":"","name":"Ubuntu2104","uuid":"35e97ee4-5cb4-42fa-a777-a2dec94843d7"},"type":"","disk_size_mib":null,"volume_group_reference":null},{"device_properties":{"type":"","disk_address":{"type":"","device_index":1,"adapter_type":"SCSI"},"device_type":"DISK"},"operation":"modify","data_source_reference":null,"type":"","disk_size_mib":{"type":"","operation":"equal","editable":false,"value":"102400"},"volume_group_reference":null},{"device_properties":{"type":"","disk_address":{"type":"","device_index":2,"adapter_type":"SCSI"},"device_type":"DISK"},"operation":"modify","data_source_reference":null,"type":"","disk_size_mib":{"type":"","operation":"equal","editable":false,"value":"102400"},"volume_group_reference":null},{"device_properties":{"type":"","disk_address":{"type":"","device_index":3,"adapter_type":"SCSI"},"device_type":"DISK"},"operation":"modify","data_source_reference":null,"type":"","disk_size_mib":{"type":"","operation":"equal","editable":false,"value":"102400"},"volume_group_reference":null},{"device_properties":{"type":"","disk_address":{"type":"","device_index":4,"adapter_type":"SCSI"},"device_type":"DISK"},"operation":"modify","data_source_reference":null,"type":"","disk_size_mib":{"type":"","operation":"equal","editable":false,"value":"102400"},"volume_group_reference":null}],"nic_delete_allowed":false,"type":"nutanix","memory_size_mib_ruleset":{"type":""},"categories_add_allowed":false},"deployment_strategy":{"type":""},"uuid":"48d16901-64c5-77ea-7dc3-959a5e96d342"}],"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_profile","name":"Default"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Config1_meta_task"}],"name":"SYS_GEN__DAG_Patch_Config1_8c2498ed_523c_2058_c729_a874e0899c29","attrs":{"edges":[],"type":"DAG"},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_profile","name":"Default"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Config1_update_spec_task"},{"kind":"app_task","name":"Config1_master"}],"name":"Config1_meta_task","attrs":{"type":"","patch_attrs_reference":["48d16901-64c5-77ea-7dc3-959a5e96d342"]},"timeout_secs":"0","type":"PATCH_META","variable_list":[]},{"target_any_local_reference":{"kind":"app_profile","name":"Default"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Config1_update_spec_task","attrs":{"type":""},"timeout_secs":"0","type":"UPDATE_SPEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"fc73d065_deployment"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"SYS_GEN__stop"},{"kind":"app_task","name":"SYS_GEN__Nutanix_Update_5b74354e_055c_43be_92dd_568e81dff2f1"},{"kind":"app_task","name":"SYS_GEN__start"}],"name":"Config1_master","attrs":{"loop_variable":"","type":"","loop_counter":"","exit_condition_type":"","patch_attr_reference":"48d16901-64c5-77ea-7dc3-959a5e96d342","loop_over_list":""},"timeout_secs":"0","type":"FOR_LOOP","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"SYS_GEN__stop","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"4426315f_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]},{"target_any_local_reference":{"kind":"app_substrate","name":"k1m"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"SYS_GEN__Nutanix_Update_5b74354e_055c_43be_92dd_568e81dff2f1","attrs":{"type":""},"timeout_secs":"0","type":"UPDATE_NUTANIX","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"master"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"SYS_GEN__start","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"a7b2b618_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"SYS_GEN__Runbook_Patch_Config1_8c2498ed_523c_2058_c729_a874e0899c29","main_task_local_reference":{"kind":"app_task","name":"SYS_GEN__DAG_Patch_Config1_8c2498ed_523c_2058_c729_a874e0899c29"},"variable_list":[]},"config_reference_list":[],"description":""}],"description":"","action_list":[],"name":"Default","restore_config_list":[],"snapshot_config_list":[],"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"DOCKER_VERSION","value":"20.10.10","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"K8S_VERSION","value":"1.22.2","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"NUTANIX"},"type":"USER"},"name":"kubeadmx"},"api_version":"3.0","metadata":{"last_update_time":"1635235046206704","kind":"blueprint","spec_version":52,"creation_time":"1635132795025203","name":"kubeadmx"}}